<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="renderer" content="webkit">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
		<title>智慧统计</title>
		<link rel="stylesheet" href="layuiadmin/layui/css/layui.css" />
		<link rel="stylesheet" href="layuiadmin/dist/style/admin.css" />
		<link rel="stylesheet" href="layuiadmin/layui/css/public.css" />
		<link rel="stylesheet" href="layuiadmin/layui/css/index.css" />
		<style>
			.layui-card-header h3{font-size:14px;line-height:1.5;}
		</style>
	</head>
	<body>
		<div class="header">
			<header>
				<h2>智慧统计</h2>
				<!-- 搜索框 -->
				<div class="search-wrap">
					<form class="layui-form" action="">
						<input type="text" name="title" id="title" required lay-verify="required" placeholder="请输入关键词" autocomplete="off"
						 class="layui-input">
						</from>
				</div>
			</header>
		</div>

		<div class="layui-container main-wrap">
			<!-- 轮播图 -->
			<div class="layui-carousel" id="test1">
				<div carousel-item>
					<div class="rotation_wrap1">管理会计指标专题</div>
					<div class="rotation_wrap2">有线宽带专题</div>
					<div class="rotation_wrap3">全国2019年3月份经分报告</div>
				</div>
			</div>
			<!-- 选项卡tabs切换 -->
			<div class="layui-tab layui-tab-brief" lay-filter="docDemoTabBrief">
				<ul class="layui-tab-title layui-row">
					<li class="layui-this layui-col-xs6">推荐</li>
					<li class="layui-col-xs6">关注</li>
				</ul>
				<div class="layui-tab-content">
					<div class="layui-tab-item layui-show layui-anim layui-anim-upbit">
						<ul class="layui-card-list" id="recommend"></ul>
					</div>
					<div class="layui-tab-item layui-anim layui-anim-upbit" id="follow_wrap">
						<a class="layui-btn layui-btn-fluid" id="follow"><i class="layui-icon layui-icon-add-1"></i>添加自选指标</a>
					</div>
				</div>
			</div>
		</div>
		<div class="copyright">
			Copyright &copy; 2019 中国移动通信集团有限公司研究院
		</div>
		<div class="footer">
			<footer>
				<ul>
					<li class="active">
						<a href="index.html"><i class="footer-bg1">&nbsp;</i></br>首页</a>
					</li>
					<li>
						<a href="quota.html"><i class="footer-bg2">&nbsp;</i></br>指标</a>
					</li>
					<li>
						<a href="special.html"><i class="footer-bg3">&nbsp;</i></br>专题</a>
					</li>
					<li>
						<a href="report.html"><i class="footer-bg4">&nbsp;</i></br>报告</a>
					</li>
					<li>
						<a href="user.html"><i class="footer-bg5">&nbsp;</i></br>我的</a>
					</li>
				</ul>
			</footer>
		</div>
		<script src="layuiadmin/layui/layui.js"></script>
		<script src="layuiadmin/layui/js/watermark.js"></script>
		<script>
			watermark({
				watermark_txt: "18663105621"
			}) //传入动态水印内容

			layui.use(['jquery', 'form', 'carousel', 'element'], function() {
				var $ = layui.$
				var form = layui.form; //搜索框
				form.on('submit(*)', function(data) {
					console.log(data.elem) //被执行事件的元素DOM对象，一般为button对象
					console.log(data.form) //被执行提交的form对象，一般在存在form标签时才会返回
					console.log(data.field) //当前容器的全部表单字段，名值对形式：{name: value}
					//阻止表单跳转。如果需要表单跳转，去掉这段即可。
					
				});
				$(document).keydown(function(event) {
					if (event.keyCode == 13) {
						window.location.href = "search.html";
					}
				});
				var carousel = layui.carousel; //轮播图
				//建造实例
				var options = {
					elem: '#test1',
					width: '100%', //设置容器宽度
					height: 160, //设置容高度
					arrow: 'none', //始终不显示箭头
					autoplay: true, //自动播放
					anim: 'fade', //切换动画方式
					interval: 3000, //自动切换的时间间隔，单位：ms（毫秒），不能低于800
				}
				carousel.render(options)
				$(".rotation_wrap1").click(function() {
					window.location.href = "quota_list.html";
				});
				$.ajax({
					type: "get",
					async: true, //异步请求
					url: "https://www.easy-mock.com/mock/5c6e22c28ef35e1f80e352ab/Intelligence_statistics/hot-search",
					data: {},
					dataType: "json", //返回数据形式为json
					success: function(data) {
						$(".hot-search").html("");
						let hot_search = "";
						$.each(data.list, function(i) {
							hot_search += `<span class="layui-badge">${data.list[i].name}</span>`
						})
						$(".hot-search").html(hot_search);
						$(".hot-search span").each(function() {
							$(this).click(function() {
								var key_word = $(this).html()
								$("#title").val(key_word)
							})
						})
					},
					error: function() {
						//请求失败时执行该函数
						layer.alert("请求数据失败!");
					}
				});

				//选项卡tabs切换
				var element = layui.element;
				//一些事件监听
				element.on('tab(demo)', function(data) {
					console.log(data);
				});
				$("#follow").click(function() {
					window.location.href = "quota.html";
				})

				//推荐指标
				$.ajax({
					type: "get",
					async: true, //异步请求
					url: "https://www.easy-mock.com/mock/5c6e22c28ef35e1f80e352ab/Intelligence_statistics/index",
					data: {},
					dataType: "json", //返回数据形式为json
					success: function(data) {
						$("#recommend").html("");
						let recommend = "";
						console.log(data.list)
						$.each(data.list, function(i, f) {
							recommend +=
								`<li class="layui-card ` + `color` + i % 4 +
								`">
						<div class="layui-card-header">
							${f.name}&nbsp;(${f.company})
						</div>
						<div class="layui-card-body">
							<ul class="quota-list">`
							//$.each(data.list, function(i, f) {})
							for (var j = 0; j < f.itemlen; j++) {
								recommend += `<li><h4>${f.calvalue[j]}</h4><h5>${f.calname[j]}</h5></li>`
							}

							recommend += `</ul>
						</div>
					</li>`
						})

						function toPercent(point) {
							let str = Number(point * 100).toFixed(2);
							str += "%";
							return str;
						}
						$("#recommend").html(recommend);
						$(".quota-list li").click(function() {
							window.location.href = "issue.html";
						});
					},
					error: function() {
						//请求失败时执行该函数
						layer.alert("请求数据失败!");

					}
				});




			});
		</script>
	</body>
</html>
